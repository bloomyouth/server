<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.wql.dao.MessageMapper">
<!--    private int messageId;//启事序号-->
<!--    private String messageType;//启事类型-->
<!--    private String objectName;//物品名称-->
<!--    private String objectType;//物品类型-->
<!--    private Date messageDate;//发布日期-->
<!--    private String messageState;//启事状态-->
<!--    private String description;//具体描述-->
<!--    private String userId;//发布人-->

    <insert id="addMessage" parameterType="Message">
        INSERT INTO message VALUES(#{messageId},#{messageType},#{objectName},#{objectType},
                                   #{messageDate},#{messageState},#{description},#{userId},#{picUrl});
    </insert>

    <delete id="deleteMessage">
        DELETE FROM message WHERE messageId=#{messageId}
    </delete>

    <update id="modifyMessage" parameterType="Message">
        UPDATE message SET
            messageType=#{messageType},
            objectName=#{objectName},
            objectType=#{objectType},
            messageDate=#{messageDate},
            messageState=#{messageState},
            description=#{description},
            userId=#{userId},
            picUrl=#{picUrl}
        WHERE messageId=#{messageId}
    </update>

    <update id="acceptMessageById">
        UPDATE message SET messageState="审核通过" WHERE messageId=#{messageId}
    </update>

    <update id="rejectMessageById">
        UPDATE message SET messageState="审核未通过" WHERE messageId=#{messageId}
    </update>

    <select id="getAllMessage" resultType="Message">
--         SELECT messageId,messageType,objectName,objectType,messageDate,messageState,description,userId  FROM message;
        SELECT * FROM message
    </select>

    <select id="getAllPassedMessage" resultType="Message">
        SELECT * FROM message WHERE messageState="审核通过"
    </select>

    <select id="getAllNeedCheckMessage" resultType="Message">
        SELECT * FROM message WHERE messageState="待审核"
    </select>

    <select id="getAllNeedModifyMessage" resultType="Message">
        SELECT * FROM message WHERE messageState="审核未通过"
    </select>

    <select id="getMessageById" resultType="Message">
        SELECT * FROM message WHERE messageId=#{messageId}
    </select>

    <select id="getMessageByUserId" resultType="Message">
        SELECT * FROM message WHERE userId=#{userId}
    </select>

    <select id="getMaxMessageId" resultType="Message">
        SELECT * FROM message WHERE messageId=(SELECT MAX(messageId) FROM message)
    </select>

</mapper>